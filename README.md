# Краткое описание
Небольшое решение, которое позволяет отправлять данные полученные с устройства измирителя качества воздуха Даджет Детектор CO2, Model MT8057s на компьютерах с ОС Windows.

Ссылка на описание прибора: https://dadget.ru/catalog/datchiki_kachestva_vozdukha/detektor_uglekislogo_gaza/

Основной целью было автоматичяески получать и отправить данные на внешний ресурс, на котором в свою очередь выполняется сохранение данных и последующее отображение.
По умолчанию данные отправляются каждую минуту, при этом с прибора данные считываются - каждые 3 секунды.

К сожалению не получилось найти решения, для прямого подключения к приборы и съему данных.

Пришлось сделать реализацию двумя программами +решения)
* используя свою родную программу ZG.exe, котороая сохраняет все данные в файл CSV, а для того чтобы программа автоматом запусклась - запускаем его в качестве службы.
* написал небольшую программу - которая забирает последние данные из CSV файлы и отправляет POST заросами на внешний ресурс.

# Как установить

## Клонируем
```
git clone https://github.com/iSmartyPRO/dadget-co2.git
cd dadget-co2
```

## Запускаем программу ZG.exe в качестве службы
Командная строка или PowerShell должны быть запущены от имени администратора
В моем примере расположение папки C:\apps\dadget-co2
```
.\nssm.exe install
```
В появивишемся окне прописываем параметры для программы ZG.exe

Вкладка "Application"
Path: C:\apps\dadget-co2\ZG.exe
Startup directory: C:\apps\dadget-co2

Вкладка "Details"
Display name: CO2 Monitor
Description: Служба для мониторинг CO2

и в самом низу пишем название службы.
Service name: co2monitor

В конце нажимаем на кнопку Install Service

Служба будет установлена, далее вам надо первый запуск выполнить вручную.

# Запускаем CO2Sender
переходим в папку nodejs и устанавливаем все необходимые зависимости:
```
cd .\nodejs
npm install
```

отредактируйте конфигурационный файл, предварительно скопировав из шаблона:
```
cp .\config\index-sample.js .\config\index.js
```

Запускаем приложение в качестве службы:
```
npm run install
```

для удаления:
```
npm run uninstall
```